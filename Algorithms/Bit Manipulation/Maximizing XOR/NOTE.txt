This seems a bit brute-forcey, can this be optimized?
